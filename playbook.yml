- hosts: all

  pre_tasks:
   - ansible.builtin.apt:
        update_cache: yes

  roles:
   - geerlingguy.pip

  tasks:
   - name: Genarate .env file
     ansible.builtin.template:
        src: ./templates/.env.j2
        dest: ~/.env


   - name: Start a container
     community.docker.docker_container:
        name: my-redmine
        image: redmine
        state: started
        ports:
         - "80:3000"
        env_file: ~/.env

   - name: Import the Datadog Agent role from the Datadog collection
     import_role:
        name: datadog.dd.agent
